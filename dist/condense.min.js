!function(e,t){"use strict";"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof exports?module.exports=t:e.jabiru=t(e)}(this,function(){"use strict";var e,t,n,o=!1,a=document.head||document.getElementsByTagName("head")[0]||document.body,r=function(r,i){function s(e){d[c]=e=null,u.parentNode.removeChild(u)}var u=document.createElement("script"),c=e+t,d=o?window:window.jabiru,l=o?"":"jabiru.";t++,d[c]=function(e){"function"==typeof i?i(e):console.error("You must specify a method as a callback")},u.onload=u.onreadystatechange=function(e){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(u&&(u.onreadystatechange=null),s(e))},u.src=r+n+"="+l+c,a.appendChild(u)},i=function(n){"string"==typeof n?(e=n,t=0):console.error("Callback name must be a string")},s=function(e){"string"==typeof e?n=e:console.error("Query name must be a string")},u=function(){o=!0};return i("callback"),s("?callback"),{get:r,name:i,query:s,toGlobal:u}}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof exports?module.exports=t:e.Condense=t(e)}(this,function(){"use strict";jabiru.toGlobal(),jabiru.name("condense_callback"),jabiru.query("&callback");var e=["en","ru","it","es","sp","uk","ua","de","pt","ro","pl","fi","nl","fr","bg","sv","se","zh_tw","zh","zh_cn","tr","ca"],t=["N","NE","E","SE","S","SW","W","NW"],n=["metric","imperial"],o="http://api.openweathermap.org/data/2.5/weather?",a="img/",r=".png",i=function(){this.rawData=null,this.isSet=!1,this.hasMessageBox=!1};i.prototype={set:function(e,t,n){var o=this;return o.isSet?void console.error("The widget is already set"):e?(o.messageBox=e.querySelector("[data-condense-message]"),o.messageBox&&(o.hasMessageBox=!0),o.element=e,o.onload=t,o.onerror=n,o.get(),void 0):void console.error("You must specify an HTML Element to build the widget")},get:function(){var e,t,n,a=this,r=a.element,i=r.getAttribute("data-condense-location"),d=r.getAttribute("data-condense-latitude"),l=r.getAttribute("data-condense-longitude"),f=r.getAttribute("data-condense-language"),m=r.getAttribute("data-condense-units");d&&l&&(i={lat:d,lon:l}),a.showMessage("Setting data and location"),e=s(i),t=u(f),n=c(m),i?(a.url=o+e+t+n,a.request()):"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(e){a.url=o+"&lat="+e.coords.latitude+"&lon="+e.coords.longitude+t+n,a.request()},function(e){a.onerror&&a.onerror(e)})},request:function(){var e=this,t=encodeURI(e.url);e.showMessage("Looking for the weather"),jabiru.get(t,function(t){e.isSet=!0,e.rawData=t,e.insertData()})},insertData:function(){var e=this,t=e.rawData,n=e.element,o=e.onload;if(t=l(t,e)){for(var a in t.data){var r="[data-condense-"+a+"]",i=n.querySelector(r);i&&(i.innerHTML=t.data[a])}var s=n.querySelector("[data-condense-icon]");o&&(s?s.onload=o:o()),s&&(s.src=t.imageSrc)}e.rawData=null},showMessage:function(e){this.hasMessageBox&&"string"==typeof e&&(this.messageBox.innerHTML=e)}};var s=function(e){return e&&"object"==typeof e?"&lat="+e.lat+"&lon="+e.lon:e?"&q="+e:void 0},u=function(t){return t&&-1!==e.indexOf(t)?"&lang="+t:"&lang=en"},c=function(e){return e&&-1!==n.indexOf(e)?"&units="+e:""},d=function(e){var n=Math.round(e/45);return t[n]||"N"},l=function(e,t){return 200===e.cod?{data:{temperature:Math.round(e.main.temp),min:Math.round(e.main.temp_min),max:Math.round(e.main.temp_max),pressure:e.main.pressure,humidity:e.main.humidity,city:e.name,country:e.sys.country,description:e.weather[0].description,code:e.weather[0].id,windSpeed:e.wind.speed,windDirection:d(e.wind.deg)},imageSrc:a+e.weather[0].icon+r}:void(t.onerror&&t.onerror(e.message))};return i});
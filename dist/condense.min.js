!function(e,t){"use strict";"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof exports?module.exports=t:e.jabiru=t(e)}(this,function(){"use strict";var e="jabiru",t=0,n=function(n,a){function o(e){window[r]=e=null,i.parentNode.removeChild(i)}var i=document.createElement("script"),r=e+t;t++,window[r]=function(e){"function"==typeof a?a(e):console.error("You must specify a method as a callback")},i.onload=i.onreadystatechange=function(e){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(i&&(i.onreadystatechange=null),o(e))},i.src=n+"&callback="+r,document.head.appendChild(i)};return{get:n}}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof exports?module.exports=t:e.Condense=t(e)}(this,function(){"use strict";var e=["en","ru","it","es","sp","uk","ua","de","pt","ro","pl","fi","nl","fr","bg","sv","se","zh_tw","zh","zh_cn","tr","ca"],t=["N","NE","E","SE","S","SW","W","NW"],n=["metric","imperial"],a="http://api.openweathermap.org/data/2.5/weather?",o="img/",i=".png",r=function(){this.rawData=null,this.isSet=!1,this.hasMessageBox=!1};r.prototype={set:function(e,t){var n=this;return n.isSet?void console.error("The widget is already set"):e?(n.messageBox=e.querySelector("[data-condense-message]"),n.messageBox&&(n.hasMessageBox=!0),n.element=e,n.onload=t,n.get(),void 0):void console.error("You must specify an HTML Element to build the widget")},get:function(){var e,t,n,o=this,i=o.element,r=i.getAttribute("data-condense-location"),c=i.getAttribute("data-condense-latitude"),l=i.getAttribute("data-condense-longitude"),g=i.getAttribute("data-condense-language"),f=i.getAttribute("data-condense-units");c&&l&&(r={lat:c,lon:l}),o.showMessage("Setting data and location"),e=s(r),t=d(g),n=u(f),r?(o.url=a+e+t+n,o.request()):"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(e){o.url=a+"&lat="+e.coords.latitude+"&lon="+e.coords.longitude+t+n,o.request()})},request:function(){var e=this,t=encodeURI(e.url);e.showMessage("Looking for the weather"),jabiru.get(t,function(t){e.isSet=!0,e.rawData=t,e.insertData()})},insertData:function(){var e=this,t=e.rawData,n=e.element,a=e.onload;t=l(t,e);for(var o in t.data){var i="[data-condense-"+o+"]",r=n.querySelector(i);r&&(r.innerHTML=t.data[o])}var s=n.querySelector("[data-condense-icon]");e.showMessage("Loading widget"),a&&(s?s.onload=a:a()),s&&(s.src=t.imageSrc),e.rawData=null},showMessage:function(e){this.hasMessageBox&&"string"==typeof e&&(this.messageBox.innerHTML=e)}};var s=function(e){return e&&"object"==typeof e?"&lat="+e.lat+"&lon="+e.lon:e?"&q="+e:void 0},d=function(t){return t&&-1!==e.indexOf(t)?"&lang="+t:"&lang=en"},u=function(e){return e&&-1!==n.indexOf(e)?"&units="+e:""},c=function(e){var n=Math.round(e/45);return t[n]||"N"},l=function(e,t){return 200===e.cod?{data:{temperature:Math.round(e.main.temp),min:Math.round(e.main.temp_min),max:Math.round(e.main.temp_max),pressure:e.main.pressure,humidity:e.main.humidity,city:e.name,country:e.sys.country,description:e.weather[0].description,code:e.weather[0].id,windSpeed:e.wind.speed,windDirection:c(e.wind.deg)},imageSrc:o+e.weather[0].icon+i}:void t.showMessage(e.message)};return r});
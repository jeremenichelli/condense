!function(e,t){"use strict";"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof exports?module.exports=t:e.jabiru=t(e)}(this,function(){"use strict";var e,t,n,a=!1,o=document.head||document.getElementsByTagName("head")[0]||document.body,i=function(i,r){function s(e){d[c]=e=null,u.parentNode.removeChild(u)}var u=document.createElement("script"),c=e+t,d=a?window:window.jabiru,l=a?"":"jabiru.";t++,d[c]=function(e){"function"==typeof r?r(e):console.error("You must specify a method as a callback")},u.onload=u.onreadystatechange=function(e){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(u&&(u.onreadystatechange=null),s(e))},u.src=i+n+"="+l+c,o.appendChild(u)},r=function(n){"string"==typeof n?(e=n,t=0):console.error("Callback name must be a string")},s=function(e){"string"==typeof e?n=e:console.error("Query name must be a string")},u=function(){a=!0};return r("callback"),s("?callback"),{get:i,name:r,query:s,toGlobal:u}}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof exports?module.exports=t:e.Condense=t(e)}(this,function(){"use strict";jabiru.toGlobal(),jabiru.name("condense_callback"),jabiru.query("&callback");var e=["en","ru","it","es","sp","uk","ua","de","pt","ro","pl","fi","nl","fr","bg","sv","se","zh_tw","zh","zh_cn","tr","ca"],t=["N","NE","E","SE","S","SW","W","NW"],n=["metric","imperial"],a="http://api.openweathermap.org/data/2.5/weather?",o="img/",i=".png",r=function(){this.rawData=null,this.isSet=!1,this.hasMessageBox=!1};r.prototype={set:function(e,t){var n=this;return n.isSet?void console.error("The widget is already set"):e?(n.messageBox=e.querySelector("[data-condense-message]"),n.messageBox&&(n.hasMessageBox=!0),n.element=e,n.onload=t,n.get(),void 0):void console.error("You must specify an HTML Element to build the widget")},get:function(){var e,t,n,o=this,i=o.element,r=i.getAttribute("data-condense-location"),d=i.getAttribute("data-condense-latitude"),l=i.getAttribute("data-condense-longitude"),m=i.getAttribute("data-condense-language"),f=i.getAttribute("data-condense-units");d&&l&&(r={lat:d,lon:l}),o.showMessage("Setting data and location"),e=s(r),t=u(m),n=c(f),r?(o.url=a+e+t+n,o.request()):"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(e){o.url=a+"&lat="+e.coords.latitude+"&lon="+e.coords.longitude+t+n,o.request()})},request:function(){var e=this,t=encodeURI(e.url);e.showMessage("Looking for the weather"),jabiru.get(t,function(t){e.isSet=!0,e.rawData=t,e.insertData()})},insertData:function(){var e=this,t=e.rawData,n=e.element,a=e.onload;t=l(t,e);for(var o in t.data){var i="[data-condense-"+o+"]",r=n.querySelector(i);r&&(r.innerHTML=t.data[o])}var s=n.querySelector("[data-condense-icon]");a&&(s?s.onload=a:a()),s&&(s.src=t.imageSrc),e.rawData=null},showMessage:function(e){this.hasMessageBox&&"string"==typeof e&&(this.messageBox.innerHTML=e)}};var s=function(e){return e&&"object"==typeof e?"&lat="+e.lat+"&lon="+e.lon:e?"&q="+e:void 0},u=function(t){return t&&-1!==e.indexOf(t)?"&lang="+t:"&lang=en"},c=function(e){return e&&-1!==n.indexOf(e)?"&units="+e:""},d=function(e){var n=Math.round(e/45);return t[n]||"N"},l=function(e,t){return 200===e.cod?{data:{temperature:Math.round(e.main.temp),min:Math.round(e.main.temp_min),max:Math.round(e.main.temp_max),pressure:e.main.pressure,humidity:e.main.humidity,city:e.name,country:e.sys.country,description:e.weather[0].description,code:e.weather[0].id,windSpeed:e.wind.speed,windDirection:d(e.wind.deg)},imageSrc:o+e.weather[0].icon+i}:void t.showMessage(e.message)};return r});